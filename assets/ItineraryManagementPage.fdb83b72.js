import{a as ue,aE as ce,aF as me,br as fe,aG as pe,bs as ge,aJ as ve,r as Q,aH as be,bt as ye,d as g,aI as H,bu as Ve,h as x,aL as xe,k as he,bv as _e,bw as we,ab as J,aX as Ce,m as v,p as h,q as s,ac as A,ad as _,s as u,t as a,Q as f,bd as Qe,A as De,be as ke,bf as Fe,B as X,v as P,V as w,aB as qe,ae as T,x as Se,y as N,aY as $e,bg as Ue,aC as Ie,af as Ae,ag as Pe,aZ as Ne,at as Y,au as Be,av as Ee,bx as Le,ah as je,ai as C}from"./index.59b4aced.js";import{u as Te,Q as b}from"./QInput.0bec3f65.js";import{Q as z,a as Z}from"./QTd.cf147d69.js";import{Q as S}from"./QCard.3166be82.js";import{Q as ze}from"./QForm.69148534.js";import{Q as O}from"./QCardSection.caaa60e8.js";import{Q as W}from"./QCardActions.17635811.js";import{a as Oe,Q as Me}from"./QTable.404fd5f5.js";import{Q as Re}from"./QPage.3ae45245.js";import"./QLinearProgress.8748d646.js";import"./use-fullscreen.99cb21b0.js";var Ke=ue({name:"QFile",inheritAttrs:!1,props:{...ce,...me,...fe,modelValue:[File,FileList,Array],append:Boolean,useChips:Boolean,displayValue:[String,Number],tabindex:{type:[String,Number],default:0},counterLabel:Function,inputClass:[Array,String,Object],inputStyle:[Array,String,Object]},emits:[...pe,...ge],setup(i,{slots:r,emit:D,attrs:$}){const{proxy:k}=he(),m=ve(),y=Q(null),t=Q(!1),F=be(i),{pickFiles:B,onDragover:U,onDragleave:q,processFiles:o,getDndNode:l}=ye({editable:m.editable,dnd:t,getFileInput:K,addFilesToQueue:G}),V=Te(i),e=g(()=>Object(i.modelValue)===i.modelValue?"length"in i.modelValue?Array.from(i.modelValue):[i.modelValue]:[]),d=g(()=>H(e.value)),ee=g(()=>e.value.map(n=>n.name).join(", ")),M=g(()=>Ve(e.value.reduce((n,c)=>n+c.size,0))),le=g(()=>({totalSize:M.value,filesNumber:e.value.length,maxFiles:i.maxFiles})),te=g(()=>({tabindex:-1,type:"file",title:"",accept:i.accept,capture:i.capture,name:F.value,...$,id:m.targetUid.value,disabled:m.editable.value!==!0})),ae=g(()=>"q-file q-field--auto-height"+(t.value===!0?" q-file--dnd":"")),R=g(()=>i.multiple===!0&&i.append===!0);function E(n){const c=e.value.slice();c.splice(n,1),L(c)}function oe(n){const c=e.value.findIndex(n);c>-1&&E(c)}function L(n){D("update:modelValue",i.multiple===!0?n:n[0])}function se(n){n.keyCode===13&&_e(n)}function ie(n){(n.keyCode===13||n.keyCode===32)&&B(n)}function K(){return y.value}function G(n,c){const p=o(n,c,e.value,R.value),j=K();j!=null&&(j.value=""),p!==void 0&&((i.multiple===!0?i.modelValue&&p.every(re=>e.value.includes(re)):i.modelValue===p[0])||L(R.value===!0?e.value.concat(p):p))}function I(){return[x("input",{class:[i.inputClass,"q-file__filler"],style:i.inputStyle})]}function ne(){if(r.file!==void 0)return e.value.length===0?I():e.value.map((c,p)=>r.file({index:p,file:c,ref:this}));if(r.selected!==void 0)return e.value.length===0?I():r.selected({files:e.value,ref:this});if(i.useChips===!0)return e.value.length===0?I():e.value.map((c,p)=>x(we,{key:"file-"+p,removable:m.editable.value,dense:!0,textColor:i.color,tabindex:i.tabindex,onRemove:()=>{E(p)}},()=>x("span",{class:"ellipsis",textContent:c.name})));const n=i.displayValue!==void 0?i.displayValue:ee.value;return n.length>0?[x("div",{class:i.inputClass,style:i.inputStyle,textContent:n})]:I()}function de(){const n={ref:y,...te.value,...V.value,class:"q-field__input fit absolute-full cursor-pointer",onChange:G};return i.multiple===!0&&(n.multiple=!0),x("input",n)}return Object.assign(m,{fieldClass:ae,emitValue:L,hasValue:d,inputRef:y,innerValue:e,floatingLabel:g(()=>d.value===!0||H(i.displayValue)),computedCounter:g(()=>{if(i.counterLabel!==void 0)return i.counterLabel(le.value);const n=i.maxFiles;return`${e.value.length}${n!==void 0?" / "+n:""} (${M.value})`}),getControlChild:()=>l("file"),getControl:()=>{const n={ref:m.targetRef,class:"q-field__native row items-center cursor-pointer",tabindex:i.tabindex};return m.editable.value===!0&&Object.assign(n,{onDragover:U,onDragleave:q,onKeydown:se,onKeyup:ie}),x("div",n,[de()].concat(ne()))}}),Object.assign(k,{removeAtIndex:E,removeFile:oe,getNativeElement:()=>y.value}),xe(m)}});const Ge={class:"row bg-primary",style:{height:"100px"}},He={class:"row"},Je={flat:"",class:"col",col:"10"},Xe={class:"col",col:"10"},Ye={class:"row"},Ze={class:"col",col:"6"},We={class:"col",col:"6"},el={class:"row"},ll={class:"col",col:"6"},tl={class:"col",col:"6"},al={class:"col",col:"6"},ol={class:"row"},sl={class:"col",col:"12"},il={class:"row"},nl={class:"col",col:"6"},dl={class:"q-pa-md"},rl=["src"],ul={class:"q-ml-sm text-center q-ml-md"},cl=["src"],ml={class:"flex",style:{"justify-content":"space-around"}},fl={class:"q-ml-sm text-center q-ml-md"},Ql={__name:"ItineraryManagementPage",setup(i){const r=J([]),D=Q(""),$=Q([]),k=Q(!1),m=Q(!1),y=[{name:"image",label:"image"},{name:"name",required:!0,label:"Name",field:o=>o.name,sortable:!0},{name:"price",field:o=>o.price,label:"Price",sortable:!0},{name:"people",field:o=>o.people,label:"People",sortable:!0},{name:"startDay",field:o=>o.startDay,label:"Start Day",sortable:!0},{name:"endDay",label:"End Day",field:o=>o.endDay,sortable:!0},{name:"edit",label:"Edit"}],t=J({_id:"",name:"",price:0,category:"",sell:!1,image:null,description:"",idx:-1,dialog:!1,valid:!1,submitting:!1,perple:"",startDay:"",endDay:""}),F=o=>{t._id=o;const l=o===""?-1:r.findIndex(V=>V._id===o);l>-1?(t.name=r[l].name,t.price=r[l].price,t.sell=r[l].sell,t.description=r[l].description,t.people=r[l].people,t.startDay=r[l].startDay,t.endDay=r[l].endDay):(t.name="",t.price=0,t.sell=!1,t.description="",t.people="",t.startDay="",t.endDay=""),t.image=null,t.idx=l,t.dialog=!0,t.valid=!1,t.submitting=!1},B=async()=>{t.submitting=!0;const o=new FormData;for(const l in t)["_id","idx","dialog","valid","submitting"].includes(l)||o.append(l,t[l]);console.log(o);try{if(t._id.length===0){const{data:l}=await A.post("/products",o);r.push(l.result),_.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:l}=await A.patch("/products/"+t._id,o);console.log("1234"),r[t.idx]=l.result,_.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),q()}t.dialog=!1}catch(l){_.fire({icon:"success",title:"\u5931\u6557",text:l.isAxiosError?l.response.data.message:l.message})}t.submitting=!1},U=async o=>{try{await A.delete("/products/"+o),await _.fire({icon:"success",title:"\u6210\u529F",text:"\u884C\u7A0B\u522A\u9664\u6210\u529F"}),q()}catch{_.fire({icon:"error",title:"\u884C\u7A0B\u522A\u9664\u5931\u6557",text:"\u884C\u7A0B\u522A\u9664\u5931\u6557"})}},q=async()=>{try{const{data:o}=await A.get("/products/all");r.splice(0,r.length),r.push(...o.result)}catch(o){console.log(o),_.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return console.log(r),q(),(o,l)=>{const V=Ce("q-card-action");return v(),h(Re,{id:"adminItinerary"},{default:s(()=>[u("div",Ge,[a(f,{flat:"",fab:"",color:"dark",icon:"mdi-plus",style:{width:"70px",height:"70px","margin-top":"15px","border-radius":"50%"},onClick:l[0]||(l[0]=e=>F(""))}),a(T,{seamless:"",modelValue:t.dialog,"onUpdate:modelValue":l[10]||(l[10]=e=>t.dialog=e),persistent:""},{default:s(()=>[a(S,{id:"dialog"},{default:s(()=>[a(Qe,null,{default:s(()=>[a(De,{src:ke,width:"35px",style:{"margin-top":"-5px"}}),a(Fe,{class:"text-weight-bold text-primary"},{default:s(()=>[X(P(o.$t("addItinerary")),1)]),_:1}),w(a(f,{flat:"",round:"",dense:"",icon:"close"},null,512),[[C]])]),_:1}),a(ze,{modelValue:t.valid,"onUpdate:modelValue":l[9]||(l[9]=e=>t.valid=e),onSubmit:qe(B,["prevent"])},{default:s(()=>[a(S,{flat:""},{default:s(()=>[u("div",He,[u("div",Je,[a(b,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.name,"onUpdate:modelValue":l[1]||(l[1]=e=>t.name=e),label:o.$t("itineraryName"),class:"q-ma-md"},null,8,["modelValue","label"])]),u("div",Xe,[a(b,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.price,"onUpdate:modelValue":l[2]||(l[2]=e=>t.price=e),label:o.$t("itineraryPrice"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),u("div",Ye,[u("div",Ze,[a(b,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.startDay,"onUpdate:modelValue":l[3]||(l[3]=e=>t.startDay=e),label:o.$t("startDay"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])]),u("div",We,[a(b,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.endDay,"onUpdate:modelValue":l[4]||(l[4]=e=>t.endDay=e),label:o.$t("endDay"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),u("div",el,[u("div",ll,[a(b,{rounded:"",flat:"",primary:"",standout:"",modelValue:t.people,"onUpdate:modelValue":l[5]||(l[5]=e=>t.people=e),type:"number",label:o.$t("people"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])]),u("div",tl,[u("div",al,[a(Ke,{modelValue:t.image,"onUpdate:modelValue":l[6]||(l[6]=e=>t.image=e),rounded:"",standout:"",counter:"",label:o.$t("image")},null,8,["modelValue","label"])])])]),u("div",ol,[u("div",sl,[a(b,{modelValue:t.description,"onUpdate:modelValue":l[7]||(l[7]=e=>t.description=e),rounded:"",standout:"",autogrow:"",type:"textarea"},null,8,["modelValue"])])]),u("div",il,[u("div",nl,[a(z,{"false-value":!1,label:`On the Shelf - ${t.sell}`,"true-value":!0,color:"green","toggle-indeterminate":"false",modelValue:t.sell,"onUpdate:modelValue":l[8]||(l[8]=e=>t.sell=e)},null,8,["label","modelValue"])])]),a(V,{class:"text-center"},{default:s(()=>[w(a(f,{type:"sumbit",label:o.$t("submit"),color:"primary",loading:t.submitting},null,8,["label","loading"]),[[C]])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),u("div",dl,[a(Me,{grid:o.$q.screen.lt.md,title:o.$t("itineraryManagement"),rows:r,columns:y,"row-key":"name",filter:D.value,selection:"multiple",selected:$.value,"onUpdate:selected":l[16]||(l[16]=e=>$.value=e)},{"top-right":s(()=>[a(b,{borderless:"",dense:"",debounce:"300",modelValue:D.value,"onUpdate:modelValue":l[11]||(l[11]=e=>D.value=e),placeholder:"Search"},{append:s(()=>[a(Se,{name:"search"})]),_:1},8,["modelValue"])]),"header-selection":s(e=>[(v(),h(z,{modelValue:e.selected,"onUpdate:modelValue":d=>e.selected=d,key:r.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-selection":s(e=>[(v(),h(z,{modelValue:e.selected,"onUpdate:modelValue":d=>e.selected=d,key:r.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-cell-image":s(e=>[a(Z,{style:{"text-align":"right"}},{default:s(()=>[a(N,null,{default:s(()=>[u("img",{src:e.row.image,alt:""},null,8,rl)]),_:2},1024)]),_:2},1024)]),"body-cell-edit":s(e=>[a(Z,{style:{"text-align":"right"}},{default:s(()=>[a(f,{round:"",class:"bg-accent",style:{width:"50px",height:"50px"},onClick:d=>F(e.row._id),icon:"mdi-circle-edit-outline"},null,8,["onClick"]),a(f,{round:"",class:"bg-red",style:{width:"50px",height:"50px"},onClick:l[12]||(l[12]=d=>k.value=!0),icon:"mdi-delete"})]),_:2},1024),a(T,{modelValue:k.value,"onUpdate:modelValue":l[13]||(l[13]=d=>k.value=d),persistent:""},{default:s(()=>[a(S,null,{default:s(()=>[a(O,{class:"row items-center"},{default:s(()=>[a(N,{icon:"mdi-delete",color:"primary","text-color":"white"}),u("span",ul,P(o.$t("Delete"))+" ?",1)]),_:1}),a(W,{align:"right"},{default:s(()=>[w(a(f,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:d=>U(e.row._id)},null,8,["onClick"]),[[C]]),w(a(f,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[C]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),item:s(e=>[u("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:$e(e.selected?"transform: scale(0.95);":"")},[a(S,{class:Ue(e.selected?"bg-grey-2":"")},{default:s(()=>[a(O,null,{default:s(()=>[a(Oe,{dense:"",modelValue:e.selected,"onUpdate:modelValue":d=>e.selected=d,label:e.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),a(Ie),(v(!0),Ae(je,null,Pe(e.cols,d=>(v(),h(Ne,{key:d.name},{default:s(()=>[a(Y,{class:"text-center"},{default:s(()=>[a(Be,{class:"text-center q-mx-auto"},{default:s(()=>[a(Y,null,{default:s(()=>[d.name!=="image"?(v(),h(Ee,{key:0,caption:"",class:"text-center q-mx-auto"},{default:s(()=>[X(P(d.value),1)]),_:2},1024)):d.name=="image"?(v(),h(N,{key:1,square:"",size:"200px",class:"text-center q-mx-auto"},{default:s(()=>[u("img",{src:e.row[d.name],alt:""},null,8,cl)]),_:2},1024)):Le("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),a(V,{class:"q-mx-auto text-center"},{default:s(()=>[u("div",ml,[a(f,{rounded:"",class:"text-center bg-red",onClick:l[14]||(l[14]=d=>m.value=!0),icon:"mdi-delete",style:{width:"50px",height:"50px"}}),a(f,{rounded:"",class:"text-center bg-accent",onClick:d=>F(e.row._id),icon:"mdi-circle-edit-outline",style:{width:"50px",height:"50px"}},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]),a(T,{modelValue:m.value,"onUpdate:modelValue":l[15]||(l[15]=d=>m.value=d),persistent:""},{default:s(()=>[a(S,null,{default:s(()=>[a(O,{class:"row items-center"},{default:s(()=>[a(N,{icon:"mdi-account-arrow-right",color:"primary","text-color":"white"}),u("span",fl,P(o.$t("Delete"))+" ?",1)]),_:1}),a(W,{align:"right"},{default:s(()=>[w(a(f,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:d=>U(e.row._id)},null,8,["onClick"]),[[C]]),w(a(f,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[C]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])],4)]),_:1},8,["grid","title","rows","filter","selected"])])]),_:1})}}};export{Ql as default};
