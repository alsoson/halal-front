import{aa as I,r as V,aW as F,m as u,p as c,q as s,s as z,ab as x,ac as p,t as i,v as t,Q as r,bc as L,B as M,bd as W,be as j,C as B,x as v,W as f,aA as O,ad as C,y as X,z as _,aX as Y,bf as G,aB as H,ae as J,af as K,aY as R,as as P,at as Z,au as ee,bx as le,ag as te,ah as g}from"./index.2cc57376.js";import{Q as m}from"./QInput.fca396b6.js";import{Q as ae}from"./QFile.e8e8a3d8.js";import{Q as q}from"./QToggle.89da4ed4.js";import{Q as y}from"./QCard.87904719.js";import{Q as oe}from"./QForm.08959a12.js";import{Q as T}from"./QTd.d7bf4043.js";import{Q as U}from"./QCardSection.14cd2284.js";import{Q as A}from"./QCardActions.70a6bc9d.js";import{a as se,Q as ie}from"./QTable.723d9ed6.js";import"./QLinearProgress.4ca3314a.js";import"./use-fullscreen.28f684fd.js";const de={class:"row bg-primary",style:{height:"100px"}},ne={class:"row"},re={flat:"",class:"col",col:"10"},ue={class:"col",col:"10"},me={class:"row"},ce={class:"col",col:"6"},pe={class:"col",col:"6"},fe={class:"row"},ge={class:"col",col:"6"},ye={class:"col",col:"6"},be={class:"col",col:"6"},Ve={class:"row"},xe={class:"col",col:"12"},ve={class:"row"},_e={class:"col",col:"6"},we={class:"q-pa-md"},he=["src"],Qe={class:"q-ml-sm text-center q-ml-md"},De=["src"],ke={class:"flex",style:{"justify-content":"space-around"}},Ce={class:"q-ml-sm text-center q-ml-md"},Le={__name:"ItineraryManagementPage",setup(qe){const n=I([]),w=V(""),$=V([]),h=V(!1),Q=V(!1),N=[{name:"image",label:"image"},{name:"name",required:!0,label:"Name",field:o=>o.name,sortable:!0},{name:"price",field:o=>o.price,label:"Price",sortable:!0},{name:"people",field:o=>o.people,label:"People",sortable:!0},{name:"startDay",field:o=>o.startDay,label:"Start Day",sortable:!0},{name:"endDay",label:"End Day",field:o=>o.endDay,sortable:!0},{name:"edit",label:"Edit"}],l=I({_id:"",name:"",price:0,category:"",sell:!1,image:null,description:"",idx:-1,dialog:!1,valid:!1,submitting:!1,perple:"",startDay:"",endDay:""}),D=o=>{l._id=o;const e=o===""?-1:n.findIndex(b=>b._id===o);e>-1?(l.name=n[e].name,l.price=n[e].price,l.sell=n[e].sell,l.description=n[e].description,l.people=n[e].people,l.startDay=n[e].startDay,l.endDay=n[e].endDay):(l.name="",l.price=0,l.sell=!1,l.description="",l.people="",l.startDay="",l.endDay=""),l.image=null,l.idx=e,l.dialog=!0,l.valid=!1,l.submitting=!1},E=async()=>{l.submitting=!0;const o=new FormData;for(const e in l)["_id","idx","dialog","valid","submitting"].includes(e)||(o.append(e,l[e]),console.log(l[e]));console.log(o);try{if(l._id.length===0){const{data:e}=await x.post("/products",o);n.push(e.result),p.fire({icon:"success",title:"\u6210\u529F",text:"\u65B0\u589E\u6210\u529F"})}else{const{data:e}=await x.patch("/products/"+l._id,o);console.log("1234"),n[l.idx]=e.result,p.fire({icon:"success",title:"\u6210\u529F",text:"\u7DE8\u8F2F\u6210\u529F"}),k()}l.dialog=!1}catch(e){p.fire({icon:"success",title:"\u5931\u6557",text:e.isAxiosError?e.response.data.message:e.message})}l.submitting=!1},S=async o=>{try{await x.delete("/products/"+o),await p.fire({icon:"success",title:"\u6210\u529F",text:"\u884C\u7A0B\u522A\u9664\u6210\u529F"}),k()}catch{p.fire({icon:"error",title:"\u884C\u7A0B\u522A\u9664\u5931\u6557",text:"\u884C\u7A0B\u522A\u9664\u5931\u6557"})}},k=async()=>{try{const{data:o}=await x.get("/products/all");n.splice(0,n.length),n.push(...o.result)}catch(o){console.log(o),p.fire({icon:"error",title:"\u5931\u6557",text:o.isAxiosError?o.response.data.message:o.message})}};return console.log(n),k(),(o,e)=>{const b=F("q-card-action");return u(),c(z,{id:"adminItinerary"},{default:s(()=>[i("div",de,[t(r,{flat:"",fab:"",color:"dark",icon:"mdi-plus",style:{width:"70px",height:"70px","margin-top":"15px","border-radius":"50%"},onClick:e[0]||(e[0]=a=>D(""))}),t(C,{seamless:"",modelValue:l.dialog,"onUpdate:modelValue":e[10]||(e[10]=a=>l.dialog=a),persistent:""},{default:s(()=>[t(y,{id:"dialog"},{default:s(()=>[t(L,null,{default:s(()=>[t(M,{src:W,width:"35px",style:{"margin-top":"-5px"}}),t(j,{class:"text-weight-bold text-primary"},{default:s(()=>[B(v(o.$t("addItinerary")),1)]),_:1}),f(t(r,{flat:"",round:"",dense:"",icon:"close"},null,512),[[g]])]),_:1}),t(oe,{modelValue:l.valid,"onUpdate:modelValue":e[9]||(e[9]=a=>l.valid=a),onSubmit:O(E,["prevent"])},{default:s(()=>[t(y,{flat:""},{default:s(()=>[i("div",ne,[i("div",re,[t(m,{rounded:"",flat:"",primary:"",standout:"",modelValue:l.name,"onUpdate:modelValue":e[1]||(e[1]=a=>l.name=a),label:o.$t("itineraryName"),class:"q-ma-md"},null,8,["modelValue","label"])]),i("div",ue,[t(m,{rounded:"",flat:"",primary:"",standout:"",modelValue:l.price,"onUpdate:modelValue":e[2]||(e[2]=a=>l.price=a),label:o.$t("itineraryPrice"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),i("div",me,[i("div",ce,[t(m,{rounded:"",flat:"",primary:"",standout:"",modelValue:l.startDay,"onUpdate:modelValue":e[3]||(e[3]=a=>l.startDay=a),label:o.$t("startDay"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])]),i("div",pe,[t(m,{rounded:"",flat:"",primary:"",standout:"",modelValue:l.endDay,"onUpdate:modelValue":e[4]||(e[4]=a=>l.endDay=a),label:o.$t("endDay"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])])]),i("div",fe,[i("div",ge,[t(m,{rounded:"",flat:"",primary:"",standout:"",modelValue:l.people,"onUpdate:modelValue":e[5]||(e[5]=a=>l.people=a),type:"number",label:o.$t("people"),class:"q-ma-md",style:{"box-shadow":"none"}},null,8,["modelValue","label"])]),i("div",ye,[i("div",be,[t(ae,{modelValue:l.image,"onUpdate:modelValue":e[6]||(e[6]=a=>l.image=a),rounded:"",standout:"",counter:"",label:o.$t("image")},null,8,["modelValue","label"])])])]),i("div",Ve,[i("div",xe,[t(m,{modelValue:l.description,"onUpdate:modelValue":e[7]||(e[7]=a=>l.description=a),rounded:"",standout:"",autogrow:"",type:"textarea"},null,8,["modelValue"])])]),i("div",ve,[i("div",_e,[t(q,{"false-value":!1,label:`On the Shelf - ${l.sell}`,"true-value":!0,color:"green",modelValue:l.sell,"onUpdate:modelValue":e[8]||(e[8]=a=>l.sell=a)},null,8,["label","modelValue"])])]),t(b,{class:"text-center"},{default:s(()=>[f(t(r,{type:"sumbit",label:o.$t("submit"),color:"primary",loading:l.submitting},null,8,["label","loading"]),[[g]])]),_:1})]),_:1})]),_:1},8,["modelValue","onSubmit"])]),_:1})]),_:1},8,["modelValue"])]),i("div",we,[t(ie,{grid:o.$q.screen.lt.md,title:o.$t("itineraryManagement"),rows:n,columns:N,"row-key":"name",filter:w.value,selection:"multiple",selected:$.value,"onUpdate:selected":e[16]||(e[16]=a=>$.value=a)},{"top-right":s(()=>[t(m,{borderless:"",dense:"",debounce:"300",modelValue:w.value,"onUpdate:modelValue":e[11]||(e[11]=a=>w.value=a),placeholder:"Search"},{append:s(()=>[t(X,{name:"search"})]),_:1},8,["modelValue"])]),"header-selection":s(a=>[(u(),c(q,{modelValue:a.selected,"onUpdate:modelValue":d=>a.selected=d,key:n.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-selection":s(a=>[(u(),c(q,{modelValue:a.selected,"onUpdate:modelValue":d=>a.selected=d,key:n.sell},null,8,["modelValue","onUpdate:modelValue"]))]),"body-cell-image":s(a=>[t(T,{style:{"text-align":"right"}},{default:s(()=>[t(_,null,{default:s(()=>[i("img",{src:a.row.image,alt:""},null,8,he)]),_:2},1024)]),_:2},1024)]),"body-cell-edit":s(a=>[t(T,{style:{"text-align":"right"}},{default:s(()=>[t(r,{round:"",class:"bg-accent",style:{width:"50px",height:"50px"},onClick:d=>D(a.row._id),icon:"mdi-circle-edit-outline"},null,8,["onClick"]),t(r,{round:"",class:"bg-red",style:{width:"50px",height:"50px"},onClick:e[12]||(e[12]=d=>h.value=!0),icon:"mdi-delete"})]),_:2},1024),t(C,{modelValue:h.value,"onUpdate:modelValue":e[13]||(e[13]=d=>h.value=d),persistent:""},{default:s(()=>[t(y,null,{default:s(()=>[t(U,{class:"row items-center"},{default:s(()=>[t(_,{icon:"mdi-delete",color:"primary","text-color":"white"}),i("span",Qe,v(o.$t("Delete"))+" ?",1)]),_:1}),t(A,{align:"right"},{default:s(()=>[f(t(r,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:d=>S(a.row._id)},null,8,["onClick"]),[[g]]),f(t(r,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[g]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])]),item:s(a=>[i("div",{class:"q-pa-xs col-xs-12 col-sm-6 col-md-4 col-lg-3 grid-style-transition",style:Y(a.selected?"transform: scale(0.95);":"")},[t(y,{class:G(a.selected?"bg-grey-2":"")},{default:s(()=>[t(U,null,{default:s(()=>[t(se,{dense:"",modelValue:a.selected,"onUpdate:modelValue":d=>a.selected=d,label:a.row.name},null,8,["modelValue","onUpdate:modelValue","label"])]),_:2},1024),t(H),(u(!0),J(te,null,K(a.cols,d=>(u(),c(R,{key:d.name},{default:s(()=>[t(P,{class:"text-center"},{default:s(()=>[t(Z,{class:"text-center q-mx-auto"},{default:s(()=>[t(P,null,{default:s(()=>[d.name!=="image"?(u(),c(ee,{key:0,caption:"",class:"text-center q-mx-auto"},{default:s(()=>[B(v(d.value),1)]),_:2},1024)):d.name=="image"?(u(),c(_,{key:1,square:"",size:"200px",class:"text-center q-mx-auto"},{default:s(()=>[i("img",{src:a.row[d.name],alt:""},null,8,De)]),_:2},1024)):le("",!0)]),_:2},1024)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)),t(b,{class:"q-mx-auto text-center"},{default:s(()=>[i("div",ke,[t(r,{rounded:"",class:"text-center bg-red",onClick:e[14]||(e[14]=d=>Q.value=!0),icon:"mdi-delete",style:{width:"50px",height:"50px"}}),t(r,{rounded:"",class:"text-center bg-accent",onClick:d=>D(a.row._id),icon:"mdi-circle-edit-outline",style:{width:"50px",height:"50px"}},null,8,["onClick"])])]),_:2},1024)]),_:2},1032,["class"]),t(C,{modelValue:Q.value,"onUpdate:modelValue":e[15]||(e[15]=d=>Q.value=d),persistent:""},{default:s(()=>[t(y,null,{default:s(()=>[t(U,{class:"row items-center"},{default:s(()=>[t(_,{icon:"mdi-account-arrow-right",color:"primary","text-color":"white"}),i("span",Ce,v(o.$t("Delete"))+" ?",1)]),_:1}),t(A,{align:"right"},{default:s(()=>[f(t(r,{flat:"",color:"primary",icon:"mdi-check-circle",onClick:d=>S(a.row._id)},null,8,["onClick"]),[[g]]),f(t(r,{flat:"",color:"primary",icon:"mdi-close-circle"},null,512),[[g]])]),_:2},1024)]),_:2},1024)]),_:2},1032,["modelValue"])],4)]),_:1},8,["grid","title","rows","filter","selected"])])]),_:1})}}};export{Le as default};
